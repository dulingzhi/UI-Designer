# æ¨¡æ¿åœ°å›¾ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

UI Designer å†…ç½®äº†ä¸€ä¸ªé¢„é…ç½®çš„ War3 1.27 æ¨¡æ¿åœ°å›¾ (`test.1.27.w3x`)ï¼Œç”¨äºå¿«é€Ÿå¯åŠ¨çƒ­é‡è½½æµ‹è¯•ã€‚æ¨¡æ¿åœ°å›¾å·²ç»åŒ…å«äº†å¿…è¦çš„è§¦å‘å™¨å’Œåˆå§‹åŒ–ä»£ç ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®å³å¯ä½¿ç”¨çƒ­é‡è½½åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ“¦ è‡ªåŠ¨é‡Šæ”¾
- æ¨¡æ¿åœ°å›¾æ‰“åŒ…åœ¨åº”ç”¨ç¨‹åºèµ„æºä¸­
- é€šè¿‡çƒ­é‡è½½é¢æ¿ä¸€é”®é‡Šæ”¾åˆ° War3 ç›®å½•
- è‡ªåŠ¨åˆ›å»ºç›®æ ‡ç›®å½•ç»“æ„

### âš™ï¸ é¢„é…ç½®åŠŸèƒ½
æ¨¡æ¿åœ°å›¾åŒ…å«ä»¥ä¸‹é¢„é…ç½®åŠŸèƒ½ï¼š
1. **DzAPI åŠ è½½** - å·²åŒ…å« `require('jass.japi')` åˆå§‹åŒ–
2. **UI é‡è½½è§¦å‘å™¨** - å“åº” `-reload` æˆ– `-rl` èŠå¤©å‘½ä»¤
3. **é”™è¯¯å¤„ç†** - å®‰å…¨çš„ Lua åŠ è½½å’Œé”™è¯¯æŠ¥å‘Š
4. **è°ƒè¯•è¾“å‡º** - è‡ªåŠ¨æ˜¾ç¤º UI åŠ è½½çŠ¶æ€

## ä½¿ç”¨æ­¥éª¤

### 1. åˆå§‹åŒ–æ¨¡æ¿åœ°å›¾

åœ¨çƒ­é‡è½½é¢æ¿ä¸­ï¼š
```
æµ‹è¯•åœ°å›¾è·¯å¾„: [è¾“å…¥æ¡†] [æµè§ˆ...] [ğŸ“¦ åˆå§‹åŒ–]
```

ç‚¹å‡» **ğŸ“¦ åˆå§‹åŒ–** æŒ‰é’®ï¼Œç³»ç»Ÿä¼šï¼š
- ä»åº”ç”¨èµ„æºä¸­æå– `test.1.27.w3x`
- å¤åˆ¶åˆ° `{War3ç›®å½•}\Maps\Test\test.w3x`
- è‡ªåŠ¨æ›´æ–°æµ‹è¯•åœ°å›¾è·¯å¾„é…ç½®

### 2. é…ç½® Lua è¾“å‡ºè·¯å¾„

ç¡®ä¿ Lua è¾“å‡ºè·¯å¾„æŒ‡å‘æ­£ç¡®ä½ç½®ï¼š
```
War3 1.27: {War3ç›®å½•}\UI-Designer\ui_generated.lua
```

### 3. å¯ç”¨çƒ­é‡è½½

å‹¾é€‰ **å¯ç”¨çƒ­é‡è½½** é€‰é¡¹ï¼š
- ç¼–è¾‘å™¨ä¼šåœ¨ä¿å­˜æ—¶è‡ªåŠ¨å¯¼å‡º Lua æ–‡ä»¶
- é˜²æŠ–å»¶è¿Ÿé»˜è®¤ 500msï¼Œå¯è°ƒæ•´

### 4. å¯åŠ¨æµ‹è¯•

ä¸¤ç§å¯åŠ¨æ–¹å¼ï¼š
1. **æ‰‹åŠ¨å¯åŠ¨**: ç‚¹å‡» "ğŸš€ å¯åŠ¨æµ‹è¯•åœ°å›¾" æŒ‰é’®
2. **è‡ªåŠ¨å¯åŠ¨**: å‹¾é€‰ "å¯¼å‡ºåè‡ªåŠ¨å¯åŠ¨æ¸¸æˆ"

### 5. æ¸¸æˆå†…ä½¿ç”¨

è¿›å…¥æ¸¸æˆåï¼š
```
åˆå§‹åŠ è½½: UI ä¼šè‡ªåŠ¨ä» ui_generated.lua åŠ è½½
çƒ­é‡è½½:   è¾“å…¥ -reload æˆ– -rl é‡æ–°åŠ è½½ UI
```

## æ¨¡æ¿åœ°å›¾å†…éƒ¨ç»“æ„

### è§¦å‘å™¨: åˆå§‹åŒ–
```lua
function InitTrig_Init()
    -- åŠ è½½ DzAPI
    require('jass.japi')
    
    -- åŠ è½½ UI
    local path = "UI-Designer\\ui_generated.lua"
    local success, err = pcall(function()
        dofile(path)
    end)
    
    if success then
        print("|cff00ff00UI åŠ è½½æˆåŠŸ|r")
    else
        print("|cffff0000UI åŠ è½½å¤±è´¥: " .. tostring(err) .. "|r")
    end
end
```

### è§¦å‘å™¨: çƒ­é‡è½½
```lua
function ReloadUI()
    -- æ¸…ç†æ—§ UI
    if ClearUIFrames then
        ClearUIFrames()
    end
    
    -- é‡æ–°åŠ è½½
    local path = "UI-Designer\\ui_generated.lua"
    local success, err = pcall(function()
        dofile(path)
    end)
    
    if success then
        print("|cff00ff00UI é‡è½½æˆåŠŸ|r")
    else
        print("|cffff0000UI é‡è½½å¤±è´¥: " .. tostring(err) .. "|r")
    end
end

-- æ³¨å†ŒèŠå¤©å‘½ä»¤
function InitTrig_Reload()
    local t = CreateTrigger()
    TriggerRegisterPlayerChatEvent(t, Player(0), "-reload", true)
    TriggerRegisterPlayerChatEvent(t, Player(0), "-rl", true)
    TriggerAddAction(t, ReloadUI)
end
```

## æ–‡ä»¶ä½ç½®

### åº”ç”¨å†…èµ„æº
```
{åº”ç”¨ç›®å½•}\resources\maps\test.1.27.w3x
```

### é‡Šæ”¾åä½ç½®
```
{War3ç›®å½•}\Maps\Test\test.w3x
```

### Lua è¾“å‡ºä½ç½®
```
{War3ç›®å½•}\UI-Designer\ui_generated.lua
```

## ç›®å½•ç»“æ„ç¤ºä¾‹

```
D:\War3\
â”œâ”€â”€ Maps\
â”‚   â””â”€â”€ Test\
â”‚       â””â”€â”€ test.w3x          # æ¨¡æ¿åœ°å›¾
â”œâ”€â”€ UI-Designer\
â”‚   â””â”€â”€ ui_generated.lua      # çƒ­é‡è½½ Lua æ–‡ä»¶
â””â”€â”€ war3.exe
```

## å¸¸è§é—®é¢˜

### Q: åˆå§‹åŒ–æŒ‰é’®ç¦ç”¨ï¼Ÿ
**A:** éœ€è¦å…ˆæ£€æµ‹åˆ° KKWEï¼Œç¡®ä¿ War3 è·¯å¾„å·²è¯†åˆ«ã€‚ç‚¹å‡» "ğŸ”„ é‡æ–°æ£€æµ‹" æŒ‰é’®ã€‚

### Q: é‡Šæ”¾å¤±è´¥ï¼Ÿ
**A:** æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. War3 ç›®å½•æ˜¯å¦æœ‰å†™å…¥æƒé™
2. `Maps\Test\` ç›®å½•æ˜¯å¦å¯ä»¥åˆ›å»º
3. æ¨¡æ¿åœ°å›¾æ–‡ä»¶æ˜¯å¦åœ¨åº”ç”¨èµ„æºä¸­

### Q: æ¸¸æˆå†…æ— æ³•åŠ è½½ UIï¼Ÿ
**A:** æ£€æŸ¥ï¼š
1. Lua è¾“å‡ºè·¯å¾„æ˜¯å¦æ­£ç¡®
2. `ui_generated.lua` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
3. åœ°å›¾è§¦å‘å™¨æ˜¯å¦æ­£ç¡®é…ç½®
4. DzAPI æ˜¯å¦å·²åŠ è½½ (War3 1.27 éœ€è¦ KKWE)

### Q: é‡è½½å‘½ä»¤æ— æ•ˆï¼Ÿ
**A:** ç¡®è®¤ï¼š
1. å·²è¿›å…¥æ¸¸æˆ (ä¸æ˜¯åœ°å›¾ç¼–è¾‘å™¨)
2. å‘½ä»¤æ ¼å¼æ­£ç¡®: `-reload` æˆ– `-rl`
3. ç©å®¶ 0 (çº¢è‰²) è¾“å…¥å‘½ä»¤
4. è§¦å‘å™¨å·²æ­£ç¡®æ³¨å†Œ

## è‡ªå®šä¹‰åœ°å›¾

å¦‚æœéœ€è¦ä½¿ç”¨è‡ªå·±çš„åœ°å›¾ï¼š

### 1. åˆ›å»ºæ–°åœ°å›¾
ä½¿ç”¨ World Editor åˆ›å»ºæ–°åœ°å›¾

### 2. æ·»åŠ è§¦å‘å™¨
å‚è€ƒä¸Šé¢çš„è§¦å‘å™¨ä»£ç ï¼Œæ·»åŠ åˆ°åœ°å›¾ä¸­

### 3. ä¿å­˜ä¸º test.w3x
ä¿å­˜åˆ° `{War3ç›®å½•}\Maps\Test\test.w3x`

### 4. æ›´æ–°é…ç½®
åœ¨çƒ­é‡è½½é¢æ¿ä¸­æµè§ˆå¹¶é€‰æ‹©æ–°åœ°å›¾è·¯å¾„

## æŠ€æœ¯ç»†èŠ‚

### Rust å‘½ä»¤
```rust
#[tauri::command]
fn extract_template_map(
    app_handle: tauri::AppHandle,
    war3_path: String,
    map_name: String
) -> Result<String, String>
```

### TypeScript è°ƒç”¨
```typescript
const targetPath = await invoke<string>('extract_template_map', {
  war3Path: kkweInfo.war3Path,
  mapName: 'test.1.27.w3x'
});
```

### èµ„æºæ‰“åŒ…é…ç½®
`tauri.conf.json`:
```json
{
  "bundle": {
    "resources": [
      "../public/maps/**"
    ]
  }
}
```

## ç›¸å…³æ–‡æ¡£

- [çƒ­é‡è½½å®ç°æ–‡æ¡£](./HOT_RELOAD_IMPLEMENTATION.md)
- [Lua ç”Ÿæˆå™¨æŒ‡å—](./LUA_GENERATOR_GUIDE.md)
- [ç”¨æˆ·æŒ‡å—](./USER_GUIDE.md)

## ç‰ˆæœ¬å…¼å®¹æ€§

| War3 ç‰ˆæœ¬ | æ¨¡æ¿åœ°å›¾ | DzAPI æ”¯æŒ |
|-----------|---------|------------|
| 1.27      | âœ… test.1.27.w3x | éœ€è¦ KKWE |
| 1.31+ (Reforged) | â³ å¾…æ”¯æŒ | åŸç”Ÿæ”¯æŒ |

---

**æç¤º**: é¦–æ¬¡ä½¿ç”¨å»ºè®®å…ˆä½¿ç”¨å†…ç½®æ¨¡æ¿åœ°å›¾æµ‹è¯•ï¼Œç†Ÿæ‚‰æµç¨‹åå†è‡ªå®šä¹‰åœ°å›¾ã€‚
