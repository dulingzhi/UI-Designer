# 自定义参考线功能说明

## 功能概述

自定义参考线是一个专业的辅助布局工具，补充了标尺功能，帮助设计师精确对齐和布局UI元素。

## 主要特性

### 1. **创建参考线**
- **从标尺拖拽**: 将鼠标移动到标尺上，按下并拖拽到画布区域，释放即可创建参考线
  - 从水平标尺拖拽创建水平参考线
  - 从垂直标尺拖拽创建垂直参考线
- 参考线会显示为蓝色细线，并在画布中可见

### 2. **移动参考线**
- **拖拽移动**: 鼠标悬停在参考线上，光标会变为调整大小图标
- 点击并拖拽参考线可以调整其位置
- 拖拽时会显示当前位置的像素值提示

### 3. **删除参考线**
- **双击删除**: 在参考线上双击鼠标左键即可删除
- **右键删除**: 在参考线上点击鼠标右键即可删除
- **清除全部**: 使用菜单 `查看 > 清除参考线` 或快捷键 `Ctrl+;` 清除所有参考线

### 4. **参考线吸附**
- 拖动UI元素时，会自动吸附到附近的参考线
- 吸附功能支持：
  - 元素左边缘吸附到参考线
  - 元素右边缘吸附到参考线
  - 元素中心吸附到参考线
- 吸附阈值为5像素

### 5. **锁定参考线**
- 可以在代码中设置参考线的 `locked` 属性为 `true` 来锁定参考线
- 锁定的参考线无法移动或删除，显示为灰色

### 6. **自定义颜色**
- 默认参考线颜色为蓝色 (`#00aaff`)
- 可以在代码中设置参考线的 `color` 属性来自定义颜色

## 使用方法

### 基本操作

1. **创建参考线**:
   - 确保标尺已显示（如果没有，点击菜单 `查看 > 显示标尺`）
   - 将鼠标移动到标尺上
   - 按住鼠标左键并拖拽到画布中
   - 释放鼠标创建参考线

2. **调整参考线位置**:
   - 将鼠标悬停在参考线上
   - 按住鼠标左键拖拽到新位置
   - 释放鼠标确定新位置

3. **删除参考线**:
   - 双击参考线
   - 或右键点击参考线

4. **清除所有参考线**:
   - 按 `Ctrl+;` 快捷键
   - 或通过菜单 `查看 > 清除参考线`

### 键盘快捷键

- `Ctrl+;` - 清除所有参考线

## 技术细节

### 数据结构

```typescript
interface GuideLine {
  id: string;                          // 唯一标识符
  orientation: 'horizontal' | 'vertical';  // 方向
  position: number;                    // 在画布中的像素位置
  wc3Position?: number;                // WC3坐标位置（可选）
  color?: string;                      // 颜色（可选，默认蓝色）
  locked?: boolean;                    // 是否锁定（可选）
}
```

### 存储位置

参考线数据存储在项目数据中：
```typescript
project.guides: GuideLine[]
```

### API 方法

项目Store提供以下方法管理参考线：

- `addGuide(guide: GuideLine)` - 添加参考线
- `updateGuide(id: string, updates: Partial<GuideLine>)` - 更新参考线
- `removeGuide(id: string)` - 删除参考线
- `clearGuides()` - 清除所有参考线

## 设计说明

### 视觉设计
- 参考线默认为半透明蓝色 (`#00aaff`)，透明度60%
- 悬停或拖拽时透明度提升到100%，并增加发光效果
- 锁定的参考线显示为灰色，透明度40%

### 交互设计
- 参考线有7像素宽的热区用于交互，提升可点击性
- 拖拽时显示位置提示，方便精确定位
- 支持键盘快捷键快速清除，提升效率

### 吸附逻辑
- 参考线吸附集成在 `snapUtils.ts` 的 `calculateSnap` 函数中
- 与元素间吸附、画布边缘吸附统一处理
- 优先级：参考线吸附 > 元素间吸附 > 画布边缘吸附

## 最佳实践

1. **精确对齐**: 使用参考线确保多个元素精确对齐到同一位置
2. **规律布局**: 创建多条等距参考线，实现规律的网格布局
3. **关键位置**: 在重要的设计位置（如黄金分割点）创建参考线
4. **临时辅助**: 参考线不会导出到最终代码，可以放心使用作为临时辅助

## 未来改进

可能的功能增强：
- [ ] 参考线管理面板，显示所有参考线列表
- [ ] 精确输入参考线位置
- [ ] 参考线命名和分组
- [ ] 参考线样式自定义（虚线、粗细等）
- [ ] 导入/导出参考线配置
- [ ] 参考线预设模板（黄金分割、九宫格等）

## 相关文件

- `src/types/index.ts` - GuideLine类型定义
- `src/store/projectStore.ts` - 参考线数据管理
- `src/components/GuideLine.tsx` - 参考线组件
- `src/components/GuideLine.css` - 参考线样式
- `src/components/Ruler.tsx` - 增强的标尺组件
- `src/components/Canvas.tsx` - 画布集成
- `src/utils/snapUtils.ts` - 吸附逻辑
